
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../MOSCAL2.0_Installation_Guide/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.14">
    
    
      
        <title>MOSCAL2.0 Hands on example - Tutorials</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exploring-the-spin-boson-model-with-moscal20" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Tutorials" class="md-header__button md-logo" aria-label="Tutorials" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tutorials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MOSCAL2.0 Hands on example
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Tutorials" class="md-nav__button md-logo" aria-label="Tutorials" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Tutorials
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MOSCAL2.0
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            MOSCAL2.0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    MOSCAL2.0 Hands on example
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    MOSCAL2.0 Hands on example
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exploring-the-spin-boson-model-with-moscal20" class="md-nav__link">
    <span class="md-ellipsis">
      Exploring the Spin-Boson Model with MOSCAL2.0
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exploring the Spin-Boson Model with MOSCAL2.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites-bose_linear_2out" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites: bose_linear_2.out
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-the-spin-boson-model" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the Spin-Boson Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-workflow-for-the-moscal20-package" class="md-nav__link">
    <span class="md-ellipsis">
      The Workflow for the MOSCAL2.0 package:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concrete-example" class="md-nav__link">
    <span class="md-ellipsis">
      Concrete example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MOSCAL2.0_Installation_Guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation guide for MOSCAL2.0
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exploring-the-spin-boson-model-with-moscal20" class="md-nav__link">
    <span class="md-ellipsis">
      Exploring the Spin-Boson Model with MOSCAL2.0
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exploring the Spin-Boson Model with MOSCAL2.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites-bose_linear_2out" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites: bose_linear_2.out
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-the-spin-boson-model" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the Spin-Boson Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-workflow-for-the-moscal20-package" class="md-nav__link">
    <span class="md-ellipsis">
      The Workflow for the MOSCAL2.0 package:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concrete-example" class="md-nav__link">
    <span class="md-ellipsis">
      Concrete example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>MOSCAL2.0 Hands on example</h1>

<h2 id="exploring-the-spin-boson-model-with-moscal20">Exploring the Spin-Boson Model with <code>MOSCAL2.0</code><a class="headerlink" href="#exploring-the-spin-boson-model-with-moscal20" title="Permanent link">&para;</a></h2>
<p>This guide aims to provide a step-by-step walkthrough of utilizing the <code>c++</code> binary program in <code>MOSCAL2.0</code> to apply the <code>DEOM</code> formalism in studying the spin-boson model. To provide an overview:</p>
<ul>
<li><strong>Prerequisites:</strong> We'll first outline the prerequisites necessary for you to successfully follow this tutorial.</li>
<li><strong>Understanding the Spin-Boson Model:</strong> We'll delve into the fundamental concepts behind the spin-boson model to lay the groundwork for our exploration.</li>
<li><strong><code>MOSCAL2.0</code> Workflow:</strong> Explaining how <code>MOSCAL2.0</code> harnesses its <code>python</code> part to generate input for the <code>c++</code> binaries used in the spin-boson model analysis.</li>
<li><strong>Generating Spin-Boson Model Inputs:</strong> We'll guide you through the process of generating inputs tailored for the spin-boson model using <code>MOSCAL2.0</code>.</li>
</ul>
<p>This walkthrough will equip you with the necessary understanding and tools to explore and analyze the spin-boson model using <code>MOSCAL2.0</code> effectively.</p>
<h3 id="prerequisites-bose_linear_2out">Prerequisites: <code>bose_linear_2.out</code><a class="headerlink" href="#prerequisites-bose_linear_2out" title="Permanent link">&para;</a></h3>
<p>Before diving into the hands-on experience with the spin-boson model in <code>MOSCAL2.0</code>, it's essential to ensure that you have successfully compiled the package following the installation guide. </p>
<p>Additionally, make sure you have obtained the specific binary, <code>bose_linear_2.out</code>, which corresponds to the spin-boson model within the <code>MOSCAL2.0</code> package.</p>
<p>Finally, you shall install the official <code>python</code> module.</p>
<p>If you have any problems, please refer to the installation guide.</p>
<h3 id="understanding-the-spin-boson-model">Understanding the Spin-Boson Model<a class="headerlink" href="#understanding-the-spin-boson-model" title="Permanent link">&para;</a></h3>
<p>The spin-boson model serves as a fundamental framework in quantum physics, describing the interaction between a quantum system (often representing a 'spin') and a surrounding environment (the 'bath'). Such interactions can be represented by Hamiltonian
$$ H = H_\text{s} + H_\text{b} + H_\text{sb}. $$
In this model, the system Hamiltonian is a general two-state Hamiltonian, i.e., a 2-by-2 matrix. The bath are bosonic degrees of freedom, 
$$ H_\text{b} = \frac{1}{2} \sum_j \frac{\omega_j}{2}(p_j^2 + q_j^2), $$
where <span class="arithmatex">\(q_j\)</span> and <span class="arithmatex">\(p_j\)</span> are the position and momentum operators for <span class="arithmatex">\(j\)</span>-th oscillator, whose frequency is <span class="arithmatex">\(\omega_j\)</span> (note that we have set <span class="arithmatex">\(\hbar=1\)</span>).</p>
<p>In the vacuum, the isolated two-state system (the spin) and the bath oscillators are exactly solvable. Whereas, the interesting physics arise when these two system have interaction. </p>
<p>We will consider the simplest interaction possible -- the linear interaction: 
$$ H_\text{sb} = Q_\text{s} x_\text{B}, \quad x_\text{B} = \sum_j c_j q_j, $$
where we see a system mode, <span class="arithmatex">\(Q_\text{s}\)</span>, which is a 2-by-2 matrix, interacts with a collective phonon mode <span class="arithmatex">\(x_\text{B}\)</span>. Phonon mode <span class="arithmatex">\(x_\text{B}\)</span> is a linear combination of all the bath operators.
Since we have a linear combination of ten's of thousands of oscillators (imagine a solid-state material), the collective mode <span class="arithmatex">\(x_\text{B}\)</span> corresponds to a spectral density defined by the following equation
$$ J(\omega) = \sum_j \frac{c_j}{2} \delta(\omega - \omega_j). $$
In practice, experimentalists can characterize <span class="arithmatex">\(x_\text{B}\)</span> by measuring the phonon spectra. But as theory people, we primarily use analytic spectral function to make our life easier. In particular, the Drude-Lorentz spectral function
$$ J(\omega) = \frac{2\lambda\gamma\omega}{\omega^2 + \gamma^2} $$
is the simplest one we can use. Here in the Drude spectral function:</p>
<ul>
<li><span class="arithmatex">\(\lambda\)</span> characterizes the system-bath interaction strength</li>
<li><span class="arithmatex">\(\gamma\)</span> characterizes the "peak" position </li>
</ul>
<p>(Feel free to use python <code>matplotlib</code> package to visualize this spectarl function.)</p>
<p>In conclusion, the spin-boson model characterize the linear coupling between a 2-state system and a very large bath of harmnic oscillators.
The detail of the interaction between the discrete system and the continuum bath is fully characterized by the spectral function <span class="arithmatex">\(J(\omega)\)</span>.</p>
<p>The goal of open quantum dynamics simultion is to know, if we have a initial density matrix <span class="arithmatex">\(\rho_\text{s}(t=0)\)</span> for the system, what will this reduced density matrix for <span class="arithmatex">\(t&gt;0\)</span>.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>From this very simple description of the spin-boson model, can you see why it's required for you to compile <code>bose_linear_2.out</code>.</p>
</div>
<p>Despite the goal of this tutorial is to tell you how to numerically simulate the spin-boson model using the DEOM formalism. 
It is important to know that dynamics for such model is exactly solvable on paper. If you feel interested (, and have time of course), you can check Chapter 12 of Chemical Dynamics in Condensed Phases by Abraham Nitzan.</p>
<h3 id="the-workflow-for-the-moscal20-package">The Workflow for the <code>MOSCAL2.0</code> package:<a class="headerlink" href="#the-workflow-for-the-moscal20-package" title="Permanent link">&para;</a></h3>
<p>The <code>MOSCAL2.0</code> package streamlines the process of generating inputs for simulations by following a structured workflow:</p>
<ol>
<li>
<p><strong>Utilizing Official Python Scripts:</strong> <code>MOSCAL2.0</code> provides official Python scripts designed to facilitate the generation of inputs required for simulations. These scripts are crafted to simplify the input creation process by allowing users to define parameters, configurations, and specifications in a structured manner. These scripts generate the necessary input data in <code>json</code> format, encapsulating the simulation details.</p>
</li>
<li>
<p><strong>Creating the <code>input.json</code> File:</strong> Upon executing the official Python scripts, the result is the creation of an <code>input.json</code> file. This file contains the formatted input data, encapsulating the specifics necessary for the subsequent <code>MOSCAL2.0</code> simulations. The <code>json</code> format ensures readability, portability, and ease of use for the generated input information.</p>
</li>
<li>
<p><strong>Invoking <code>MOSCAL2.0</code> Binary Execution:</strong> With the <code>input.json</code> file prepared, the next step involves invoking the relevant <code>MOSCAL2.0</code> binary files. These binaries, residing within the same directory as the <code>input.json</code> file, are executed to conduct simulations or analyses based on the provided input parameters. The binaries interpret the information within <code>input.json</code>, enabling the initiation of simulations tailored to the defined configurations.</p>
</li>
</ol>
<h3 id="concrete-example">Concrete example<a class="headerlink" href="#concrete-example" title="Permanent link">&para;</a></h3>
<p>In this example, we will simulate dynamics the following system Hamiltonian
$$ H_\text{s} = \begin{bmatrix} 1 &amp; 1 \\ 1 &amp; -1 \ \end{bmatrix}, $$
with system bath interaction
$$ H_\text{sb} = Q x_\text{B} = \begin{bmatrix} 0 &amp; 1 \\ 1 &amp; 0 \ \end{bmatrix} x_\text{B}.$$
The spectral function is
$$ J(\omega) = \frac{2\lambda\gamma\omega}{\omega^2 + \gamma^2}, \lambda = \gamma = 1.0, $$
at bath temperature <span class="arithmatex">\(k_\text{B} T = 1.0\)</span> (i.e., <span class="arithmatex">\(\beta = 1.0\)</span>).</p>
<p>First, you write your <code>python</code> script <code>spin-boson.py</code> to generate the input for the <code>bose_linear_2.out</code> binary.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># spin-boson.py</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">deom</span> <span class="kn">import</span> <span class="n">convert</span><span class="p">,</span> <span class="n">decompose_spe</span><span class="p">,</span> <span class="n">complex_2_json</span><span class="p">,</span> <span class="n">init_qmd</span>


<span class="k">def</span> <span class="nf">decompose_drude_spectral_function</span><span class="p">(</span><span class="n">npsd</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">lambd</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="n">w_sp</span><span class="p">,</span> <span class="n">lambd_sp</span><span class="p">,</span> <span class="n">gamma_sp</span><span class="p">,</span> <span class="n">beta_sp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\omega, \lambda, \gamma, \beta&quot;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">spe_vib_sp</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lambd_sp</span> <span class="o">*</span> <span class="n">gamma_sp</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma_sp</span> <span class="o">-</span> <span class="n">sp</span><span class="o">.</span><span class="n">I</span> <span class="o">*</span> <span class="n">w_sp</span><span class="p">)</span>
    <span class="n">sp_para_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">lambd_sp</span><span class="p">:</span> <span class="n">lambd</span><span class="p">,</span> <span class="n">gamma_sp</span><span class="p">:</span> <span class="n">gamma</span><span class="p">}</span>
    <span class="n">condition_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">para_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="n">beta</span><span class="p">}</span>

    <span class="n">etal</span><span class="p">,</span> <span class="n">etar</span><span class="p">,</span> <span class="n">etaa</span><span class="p">,</span> <span class="n">expn</span> <span class="o">=</span> <span class="n">decompose_spe</span><span class="p">(</span><span class="n">spe_vib_sp</span><span class="p">,</span> <span class="n">w_sp</span><span class="p">,</span> <span class="n">sp_para_dict</span><span class="p">,</span> <span class="n">para_dict</span><span class="p">,</span>
                                           <span class="n">condition_dict</span><span class="p">,</span> <span class="n">npsd</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">etal</span><span class="p">,</span> <span class="n">etar</span><span class="p">,</span> <span class="n">etaa</span><span class="p">,</span> <span class="n">expn</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1">#------------------------------------------------------------------------------#</span>
    <span class="c1"># The simulation parameters</span>
    <span class="c1">#------------------------------------------------------------------------------#</span>

    <span class="c1"># These parameters controls the dynamics</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">tf</span> <span class="o">=</span> <span class="mi">25</span>

    <span class="c1"># These parameters controls the accuracy of DEOM</span>
    <span class="n">npsd</span> <span class="o">=</span> <span class="mi">2</span>       <span class="c1"># number of exponential decays to decompose the correlation function</span>
    <span class="n">lmax</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c1"># maximum tiers for the dissipaton density operators</span>
    <span class="n">ferr</span> <span class="o">=</span> <span class="mf">1e-12</span>   <span class="c1"># the filtering tolerence (ignore the very small numbers)</span>
    <span class="n">nmax</span> <span class="o">=</span> <span class="mi">1000000</span> <span class="c1"># maximum number of dissipaton density operators</span>

    <span class="c1"># These parameters controls the bath, bath mode, and spectral function</span>
    <span class="n">beta</span>  <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># The inverse temperature 1/ (k_B T)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># gamma in drude spectral</span>
    <span class="n">lambd</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># lambda in drude spectral</span>
    <span class="n">nmod</span>  <span class="o">=</span> <span class="mi">1</span>     <span class="c1"># number of collective modes x_B to consider</span>

    <span class="c1">#------------------------------------------------------------------------------#</span>
    <span class="c1"># Hamiltonian H, system mode Q, and initial density matrix rho</span>
    <span class="c1">#------------------------------------------------------------------------------#</span>
    <span class="n">rho0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">rho0</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">rho0</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># rho0 is initilize as |0&gt;&lt;0|</span>

    <span class="n">hams</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">hams</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">hams</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">hams</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">hams</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># This is the two-state system Hamiltonian</span>

    <span class="n">qmds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nmod</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
    <span class="n">qmds</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">qmds</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># This is the interacting system mode, here we consider only one mode; essentially the mode is the pauli matrix sigma_x</span>

    <span class="n">nsys</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="c1">#------------------------------------------------------------------------------#</span>
    <span class="c1"># Decompose the spectral function (more precisely the correlation function)</span>
    <span class="c1">#------------------------------------------------------------------------------#</span>
    <span class="n">etal</span><span class="p">,</span> <span class="n">etar</span><span class="p">,</span> <span class="n">etaa</span><span class="p">,</span> <span class="n">expn</span> <span class="o">=</span> <span class="n">decompose_drude_spectral_function</span><span class="p">(</span><span class="n">npsd</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">lambd</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">expn</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">json_init</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s2">&quot;nmax&quot;</span><span class="p">:</span> <span class="n">nmax</span><span class="p">,</span>
         <span class="s2">&quot;lmax&quot;</span><span class="p">:</span> <span class="n">lmax</span><span class="p">,</span>
         <span class="s2">&quot;ferr&quot;</span><span class="p">:</span> <span class="n">ferr</span><span class="p">,</span>
         <span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
         <span class="s2">&quot;nind&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">expn</span><span class="p">),</span>
         <span class="s2">&quot;nmod&quot;</span><span class="p">:</span> <span class="n">nmod</span><span class="p">,</span>
         <span class="s2">&quot;equilibrium&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="s2">&quot;sc2&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
             <span class="s2">&quot;dt-method&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
             <span class="s2">&quot;ti&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s2">&quot;tf&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
             <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="n">dt</span><span class="p">,</span>
             <span class="s2">&quot;backup&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
         <span class="p">},</span>
         <span class="s2">&quot;expn&quot;</span><span class="p">:</span> <span class="n">complex_2_json</span><span class="p">(</span><span class="n">expn</span><span class="p">),</span>
         <span class="s2">&quot;ham1&quot;</span><span class="p">:</span> <span class="n">complex_2_json</span><span class="p">(</span><span class="n">hams</span><span class="p">),</span>
         <span class="s2">&quot;coef_abs&quot;</span><span class="p">:</span> <span class="n">complex_2_json</span><span class="p">(</span><span class="n">etaa</span><span class="p">),</span>
         <span class="s2">&quot;read_rho0&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
         <span class="s2">&quot;rho0&quot;</span><span class="p">:</span> <span class="n">complex_2_json</span><span class="p">(</span><span class="n">rho0</span><span class="p">),</span>
     <span class="p">}</span>

    <span class="n">init_qmd</span><span class="p">(</span><span class="n">json_init</span><span class="p">,</span> <span class="n">qmds</span><span class="p">,</span> <span class="n">qmds</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">nsys</span><span class="p">,</span> <span class="n">etaa</span><span class="p">,</span> <span class="n">etal</span><span class="p">,</span> <span class="n">etar</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;input.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json_init</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">convert</span><span class="p">)</span>
</code></pre></div>
<p>Run this script,</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>spin-boson.py
</code></pre></div>
<p>then you shall see <code>input.json</code> in the current directory.</p>
<p>Finally, you can run your <code>MOSCAL</code> program by executing these commands in your command line:
<div class="highlight"><pre><span></span><code><span class="nv">MOSCAL_BIN</span><span class="o">=</span><span class="s2">&quot;/path/to/bose_linear_2.out&quot;</span>

<span class="si">${</span><span class="nv">MOSCAL_BIN</span><span class="si">}</span><span class="w"> </span><span class="c1"># make sure you have input.json in your working directory</span>
</code></pre></div>
(Alternatively, you can write a shell script <code>run_spin_boson.sh</code> to do this.)</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.cd18aaf1.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>